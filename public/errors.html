<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Syncthing Errors</title>
    <style>
      body { margin: 0; padding: 24px; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial; }
      h1 { margin: 0 0 16px; font-size: 20px; }
      table { width: 100%; border-collapse: collapse; }
      th, td { padding: 10px; border-bottom: 1px solid #ccc; text-align: left; vertical-align: top; }
      th { background: rgba(0,0,0,0.05); position: sticky; top: 0; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    </style>
  </head>
  <body>
    <h1>Node Errors</h1>
    <div id="meta" class="mono"></div>
    <table>
      <thead>
        <tr>
          <th>When</th>
          <th>Message</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
    <script type="module">
      function qs(name) { const p = new URLSearchParams(location.search); return p.get(name); }
      async function load() {
        const node = qs('node');
        document.getElementById('meta').textContent = node ? `Node: ${node}` : '';
        const res = await fetch('/api/nodes');
        const data = await res.json();
        const target = data.nodes.find(n => n.name === node) || data.nodes[0];
        const tbody = document.getElementById('tbody');
        tbody.innerHTML = '';
        (target?.errors || []).forEach(e => {
          const tr = document.createElement('tr');
          const td1 = document.createElement('td');
          td1.textContent = e.when ? new Date(e.when).toLocaleString() : '';
          const td2 = document.createElement('td');
          td2.textContent = e.message || '';
          tr.appendChild(td1); tr.appendChild(td2);
          tbody.appendChild(tr);
        });
      }
      load();
    </script>
  </body>
  </html>


